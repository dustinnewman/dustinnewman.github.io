<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Dustin Newman's blog"><link rel="shortcut icon" type=image/x-icon href=https://dustinnewman.net/favicon.ico><link rel=stylesheet href=/css/style.min.css><title>The Unreasonable Pain of Archiving Twitter</title></head><body><header><h2><a href=https://dustinnewman.net>Dustin Newman</a></h2><nav><ul><li><a href=/ title=posts>posts</a></li><li><a href=/about/ title=about>about</a></li></ul></nav></header><main><article><header><h1>The Unreasonable Pain of Archiving Twitter</h1><div><time>June 11, 2022</time></div></header><p>I am currently in the process of archiving a large number of tweets. I am keeping these tweets in the hopes that I can look back later and either laugh at the hubris or bang my head for not seeing the obvious writing on the wall. Naturally, I have an interest in making sure these tweets are viewable long into the future, perhaps years. Who knows what the world will look like in 10 years, much less 40. Will Markdown be popular? Will Twitter have faded from existence? Will even the mighty HTML slip into memory? This uncertainty makes archiving a tricky, even slightly neurotic task. The entire point is to future-proof right now. I want to gather all the important data right now, to keep forever, because it is very likely, almost guaranteed, 99% of it will no longer exist or be reachable. Since I want these tweets to be in the best possible format, that is the one that gives the highest chance of being easily readable in the future, I have gone through quite the dilemma with this archiving journey. These are roughly the steps and pitfalls I have encountered along the way.</p><p>As I cover each area, I will use a recent <a href=https://twitter.com/Reuters/status/1535478193183924224/>tweet by Reuters</a> as an illustrative example.</p><p><img src=./1535478193183924224.png alt="Screenshot of tweet by Reuters reading &amp;ldquo;U.S. CDC rescinds COVID-19 international air testing rules&amp;rdquo; with an image of a man walking in an airport past an orange sign that reads &amp;ldquo;COVID-19 Testing&amp;rdquo;."></p><h2 id=paper>Paper</h2><p>Let&rsquo;s just get it out of the way right now. Yes, a hard (paper) copy is the best format in terms of longevity. You need no interpreters, no software, not even electricity: just your eyesight. However, seeing as I am archiving upwards of twenty thousand tweets, suffice it to say that I have neither the space nor the ink to print and save twenty thousand pages of tweets.</p><h2 id=screenshots>Screenshots</h2><p>One of the easiest archival methods is to take screenshots. It has certainly worked for many a cancelled celebrity and proven fairly durable. Screenshots are immediately visual, not prohibitively large in size, and intuitive. They preserve quite a bit of extra information as well, from the current design of Twitter to likes, retweets, and timestamps. You could even name the files by tweet ID to save that information meta-textually as well. However, because they are image formats, I am reliant on PNG files being readable long into the future. Granted, since we have so much data already saved as PNGs, there is a certain &ldquo;safety in numbers&rdquo; logic to saving tweets as PNGs. However, this is personally not a risk I want to take. Further, if I need to do any analysis or search of the tweets in the future (which is somewhat likely), an image format will make this impossible barring OCR.</p><h2 id=html>HTML</h2><p>Boom, just go right to <code>File > Save As... > HTML</code> and you have an exact copy of what you see in your browser. Plus, it&rsquo;s plaintext, preserves all visible information about the tweet, and is in a common format unlikely to be dropped or forgotten. Let&rsquo;s do it!</p><p><img src=./html.png alt="Screenshot of Twitter error message reading &amp;ldquo;Hmm&amp;hellip; this page doesn&amp;rsquo;t exist. Try searching for something else.&amp;rdquo;"></p><p>Oh. Yep, that&rsquo;s right. Twitter will only show the actual tweet contents if you are browsing from twitter.com. I wasn&rsquo;t quite motivated enough to figure out the nitty-gritty of the various ways they do this and doing so would mean I would need to write some kind of &ldquo;unlocker&rdquo; script to remove all these measures which is not only time-consuming, but somewhat tampers with the authenticity of the archives themselves, since I modified them, but we can see that preventing off-site browsing is at least somewhat intentional on the part of Twitter from this little snippet at the end of their page:</p><pre><code class=language-html>&lt;script nonce=&quot;abcdefg123456789&quot;&gt;document.cookie = decodeURIComponent(&quot;gt=123456789; Max-Age=10800; Domain=.twitter.com; Path=/; Secure&quot;);&lt;/script&gt;
</code></pre><p>(And yes, I grepped the HTML file already, there is very little information preserved in the file itself. It&rsquo;s not as though there is a full-text copy of the tweet in the file and Twitter merely includes a script to obfuscate this. Actually loading the tweet needs to pass some origin checks.)</p><h2 id=dom-dump>DOM Dump</h2><p>But that was just the page source. With SPA apps, it is very common for the actual page source to be nothing but a JavaScript wrapper that loads the app itself. Once loaded, you can capture the DOM tree as it appears in your browser to get a view of exactly what was on your screen at that time. Sure, it might require some trickery to programmatically capture this DOM dump, but once you have it, it will be identical to what you saw.</p><p><img src=./html.png alt="Screenshot of Twitter error message reading &amp;ldquo;Hmm&amp;hellip; this page doesn&amp;rsquo;t exist. Try searching for something else.&amp;rdquo;"></p><p>Oh.</p><p>It is worth noting that this DOM dump HTML does actually include the tweet as we can see here</p><pre><code class=language-html>&lt;span class=&quot;css-901oao css-16my406 r-poiln3 r-bcqeeo r-qvutc0&quot;&gt;U.S. CDC rescinds COVID-19 international air testing rules &lt;/span&gt;
</code></pre><p>as well as a lot of information in the meta tags in the head. However, this is still not ideal for archiving. I would either need to strip out all this DRM-esque script nonsense (thus raising the possibility I might modify the contents of these tweets accidentally or on purpose) or not be able to open the HTML file in the future.</p><h3 id=webarchive>WebArchive</h3><p>Okayyy, so just plain HTML is out of the picture. However, the Internet Archive stores tons of snapshots of tweets every day. Surely, they must have a way right?</p><p><img src=./wayback_machine.png alt="Screenshot of Internet Archive snapshot of the tweet. The tweet is full width and missing a lot of the styling of the original."></p><p>While they do seem to be more successful than I was, this too has its own share of problems. The first being that we want to archive over twenty thousand tweets, a task which would not only result in my likely ban from the Internet Archive, but would also be reliant on the Archive both (a) staying up and live and (b) not removing/pruning large amounts of my archive. Seeing as the vast, vast majority of these tweets will only be of interest to me, this is not a risk I want to take.</p><p>So, let&rsquo;s make our own archive then. After all, the WARC format is open-source and standardized, so there is broad support for keeping these files into the future. We run <code>File > Save As... WebArchive</code> and&mldr;</p><p><img src=./1535478193183924224.png alt="Screenshot of original Reuters tweet."></p><p>Huzzah! Now that that&rsquo;s out of the way, let&rsquo;s just turn off our Wi-Fi connectivity and make sure that-</p><p><img src=./web_archive.png alt="Screenshot of error message."></p><p>I almost didn&rsquo;t believe it, but, yes, for some reason, when the Internet Archive makes an archive of a tweet, it is okay. However, when I do it, I am required to have Wi-Fi connectivity and connect to Twitter&rsquo;s servers. We can clearly see that these two WebArchives (mine vs the Internet Archive&rsquo;s) are different even without shutting our Wi-Fi off. Theirs has different styling than the usual Twitter UI, not just night mode vs light mode, but the entire page seems to be a special, slimmed-down version of what most people see. Whereas my WebArchive was 6.7 MB of all that JavaScript goodness, the one I downloaded from the Wayback Machine was a measly 431 KB. To me, this indicates that either Internet Archive or Twitter is specifying the equivalent of <code>User-Agent: InternetArchive</code> somewhere and that changes the archive file from a bloated, network-dependent mess into a minimal, standalone file. Regardless, there is no way I can ask the Internet Archive to download some twenty thousand tweets, so we need to find another way.</p><h3 id=json>JSON</h3><p>And we arrive. The last stop of our journey. For now, I have decided to archive all of these tweets in JSON format with the help of the Twitter API. Even with the free tier, I am allowed up to 500k tweets per month, more than enough for my needs. JSON allows us quite a bit of future-proofing. Even if JSON is lost and forgotten someday, it is still a plaintext format, meaning that, as long as we avoid some of the more crazy or nested structures, we should be okay and able to convert to a variety of different formats later. It is far easier to analyze/search than screenshots and more Twitter-proof than WebArchives since, as we saw, Twitter can call their own APIs and render our archives invalid any time they wish. With JSON, at least I have the raw data I am interested in. If needed, I figure I can always write a parser to take all the JSON files and plug them into a duplicate of the Twitter UI later. Even if the authenticity of the UI is in question, at least I will know the data itself will be from the source. For reference, the schema will look something like this</p><pre><code class=language-json>{
    author_id: &quot;&quot;,
    conversation_id: &quot;&quot;,
    entities: {
        mentions: [],
        referenced_tweets: [],
    },
    text: &quot;&quot;,
    id: &quot;&quot;,
    created_at: &quot;&quot;,
    public_metrics: {
        retweet_count: 0,
        reply_count: 0,
        like_count: 0,
        quote_count: 0,
    },
    source: &quot;&quot;,
    in_reply_to_user_id: &quot;&quot;
}
</code></pre><p>Basically, we can support a fair bit of complexity from replies to retweets to retweets as replies, all encoded with tweet and user IDs rather than relying on HTML-facing metrics such as handle (which can change over time). This is also by far the slimmest, most minimal of the formats, which, given I am working with a 2 TB flash drive, is much appreciated.</p><p>If you came to this post from a search engine/social media site expecting a golden solution, I have nothing for you, sorry. Except complaints. I have many complaints.</p></article></main><footer></footer></body></html>